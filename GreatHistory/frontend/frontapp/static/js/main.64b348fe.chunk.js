(this.webpackJsonpfrontapp=this.webpackJsonpfrontapp||[]).push([[0],{38:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var s=n(1),a=n.n(s),c=n(31),r=n.n(c),i=(n(38),n(10)),o=n(11),l=n(12),u=n(13),j=(n(39),n(8)),h=n(2),d=n(0);var b=function(e){var t,n,s,a=e.isAuthenticated,c=e.logout;return t="/login",n="login",a&&(t="/logout",n="logout",s=c),Object(d.jsxs)("header",{className:"d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom",children:[Object(d.jsx)(j.b,{to:"/",className:"d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none",children:"GreatHistory"}),Object(d.jsxs)("ul",{className:"nav nav-pills",children:[Object(d.jsx)("li",{className:"nav-item",children:Object(d.jsx)(j.b,{to:"/users",className:"nav-link",children:"Users"})}),Object(d.jsx)("li",{className:"nav-item",children:Object(d.jsx)(j.b,{to:"/categories",className:"nav-link",children:"Categories"})}),Object(d.jsx)("li",{className:"nav-item",children:Object(d.jsx)(j.b,{to:t,className:"nav-link",onClick:s,children:n})})]})]})},O=function(){return Object(d.jsx)("footer",{children:"\xa9 KPK, 2021"})},m=function(e){var t=e.user;return Object(d.jsxs)("tr",{className:"user-row",children:[Object(d.jsx)("td",{children:t.id}),Object(d.jsx)("td",{children:t.username}),Object(d.jsx)("td",{children:t.date_birth})]})},x=function(e){var t=e.users;return Object(d.jsxs)("div",{className:"user-list",children:[Object(d.jsx)("h1",{children:"Users"}),Object(d.jsxs)("table",{className:"user-list__table",children:[Object(d.jsx)("thead",{children:Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{children:"id"}),Object(d.jsx)("th",{children:"username"}),Object(d.jsx)("th",{children:"date birth"})]})}),Object(d.jsx)("tbody",{children:t.map((function(e){return Object(d.jsx)(m,{user:e},e.id)}))})]})]})},g=function(){return Object(d.jsx)("h1",{children:"Hello from SPA"})},f=function(e){var t=e.category;return Object(d.jsxs)("tr",{className:"project-row",children:[Object(d.jsx)("td",{children:t.id}),Object(d.jsx)("td",{children:Object(d.jsx)(j.b,{to:"/categories/detail/".concat(t.id),className:"nav-link",children:t.name})}),Object(d.jsx)("td",{children:t.desc}),Object(d.jsx)("td",{children:Object(d.jsx)(j.b,{to:"/categories/delete/".concat(t.id),className:"nav-link",children:"delete"})})]})},p=function(e){var t=e.categories;return Object(d.jsxs)("div",{className:"project-list",children:[Object(d.jsx)("h1",{children:"Categories"}),Object(d.jsxs)("table",{className:"project-list__table",children:[Object(d.jsx)("thead",{children:Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{children:"id"}),Object(d.jsx)("th",{children:"name"}),Object(d.jsx)("th",{children:"desc"})]})}),Object(d.jsx)("tbody",{children:t.map((function(e){return Object(d.jsx)(f,{category:e},e.id)}))})]})]})},v=n(19),k=n.n(v),y=n(18),S=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(i.a)(this,n),(s=t.call(this,e)).state={username:"",password:""},s}return Object(o.a)(n,[{key:"handleChange",value:function(e){this.setState(Object(y.a)({},e.target.name,e.target.value))}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.login(this.state.username,this.state.password)}},{key:"render",value:function(){var e=this;return Object(d.jsx)("div",{className:"login-form",children:Object(d.jsxs)("form",{method:"post",onSubmit:function(t){return e.handleSubmit(t)},children:[Object(d.jsx)("input",{type:"text",name:"username",placeholder:"username",onChange:function(t){return e.handleChange(t)}}),Object(d.jsx)("input",{type:"password",name:"password",placeholder:"password",onChange:function(t){return e.handleChange(t)}}),Object(d.jsx)("input",{type:"submit",value:"login"})]})})}}]),n}(a.a.Component),C=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(i.a)(this,n),(s=t.call(this,e)).state={username:"",password1:"",password2:"",email:""},s}return Object(o.a)(n,[{key:"handleChange",value:function(e){this.setState(Object(y.a)({},e.target.name,e.target.value))}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.register(this.state.username,this.state.password1,this.state.password2,this.state.email)}},{key:"render",value:function(){var e=this;return Object(d.jsx)("div",{className:"login-form",children:Object(d.jsxs)("form",{method:"post",onSubmit:function(t){return e.handleSubmit(t)},children:[Object(d.jsx)("input",{type:"text",name:"username",placeholder:"username",onChange:function(t){return e.handleChange(t)}}),Object(d.jsx)("input",{type:"password",name:"password",placeholder:"password",onChange:function(t){return e.handleChange(t)}}),Object(d.jsx)("input",{type:"submit",value:"login"})]})})}}]),n}(a.a.Component),N=function(e){return"".concat("http://127.0.0.1:8000","/api/").concat(e,"/")},w=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(i.a)(this,n),(s=t.call(this,e)).state={users:[],categories:[],accessToken:s.getAccessToken()},s}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.loadState()}},{key:"loadState",value:function(){var e=this,t=this.getHeaders();k.a.get(N("users"),{headers:t}).then((function(t){e.setState({users:t.data})})).catch((function(e){return console.log(e)})),k.a.get(N("categories"),{headers:t}).then((function(t){e.setState({categories:t.data})})).catch((function(e){return console.log(e)}))}},{key:"login",value:function(e,t){var n=this;k.a.post(N("token"),{username:e,password:t}).then((function(e){var t=e.data.refresh,s=e.data.access;console.log(s),n.saveTokens(t,s),n.setState({accessToken:s},n.loadState)})).catch((function(e){return console.log(e)}))}},{key:"register",value:function(e,t,n,s){console.log("do register",e,t,n,s)}},{key:"logout",value:function(){localStorage.setItem("refreshToken",null),localStorage.setItem("accessToken",null),this.clearState()}},{key:"clearState",value:function(){this.setState({accessToken:null,users:[],categories:[]})}},{key:"saveTokens",value:function(e,t){localStorage.setItem("refreshToken",e),localStorage.setItem("accessToken",t)}},{key:"getAccessToken",value:function(){return localStorage.getItem("accessToken")}},{key:"isAuthenticated",value:function(){return"null"!==this.state.accessToken&&null!==this.state.accessToken}},{key:"getHeaders",value:function(){var e={"Content-Type":"application/json"};return this.isAuthenticated()&&(e.Authorization="Bearer ".concat(this.state.accessToken)),e}},{key:"render",value:function(){var e=this;return Object(d.jsxs)("div",{className:"main",children:[Object(d.jsxs)(j.a,{children:[Object(d.jsx)(b,{isAuthenticated:this.isAuthenticated(),logout:function(){return e.logout()}}),Object(d.jsx)(h.a,{exact:!0,path:"/",children:Object(d.jsx)(g,{})}),Object(d.jsx)(h.a,{exact:!0,path:"/users",children:Object(d.jsx)(x,{users:this.state.users})}),Object(d.jsx)(h.a,{exact:!0,path:"/categories",children:Object(d.jsx)(p,{categories:this.state.categories})}),Object(d.jsx)(h.a,{exact:!0,path:"/login",children:Object(d.jsx)(S,{login:function(t,n){return e.login(t,n)}})}),Object(d.jsx)(h.a,{exact:!0,path:"/register",children:Object(d.jsx)(C,{register:function(t,n,s,a){return e.register(t,n,s,a)}})})]}),Object(d.jsx)(O,{})]})}}]),n}(a.a.Component),T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,68)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),s(e),a(e),c(e),r(e)}))};r.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(w,{})}),document.getElementById("root")),T()}},[[67,1,2]]]);
//# sourceMappingURL=main.64b348fe.chunk.js.map